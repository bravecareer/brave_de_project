unit_tests:
  - name: test_price_calculation
    description: "Check that price calculation logic correctly handles discounts and edge cases"
    model: stg_product_data
    given:
      - input: source('de_project', 'product_data') 
        rows:
          - {product_id: 101, product_name: 'Test Product 1', product_category: 'electronics', price: 100.00, supplier_id: 'S001'}
          - {product_id: 102, product_name: 'Test Product 2', product_category: 'clothing', price: 50.00, supplier_id: 'S002'}
          - {product_id: 103, product_name: 'Test Product 3', product_category: 'home', price: null, supplier_id: 'S003'}
          - {product_id: 104, product_name: 'Test Product 4', product_category: 'electronics', price: -10.00, supplier_id: 'S001'}
          - {product_id: 105, product_name: 'Test Product 5', product_category: 'clothing', price: 200.00, supplier_id: 'S002'}
    expect:
      rows:
        - {product_id: 101, price: 100.00}
        - {product_id: 102, price: 50.00}
        - {product_id: 103, price: 0.00}  # NULL price should be converted to 0
        - {product_id: 104, price: 0.00}  # Negative price should be converted to 0
        - {product_id: 105, price: 200.00}
