unit_tests:
  - name: test_correct_inventory_data
    description: "Check if rating, weight and discount are correct in dim inventory table"
    model: dim_inventory_michael_w
    given:
      - input: source('de_project', 'inventory_data') 
        rows:
          - {inventory_id: 1, rating: 4.55, weight: 21.93, discounts: 26.06}
          - {inventory_id: 2, rating: '3,0401306928136800', weight: 38.41, discounts: 20.65}
          - {inventory_id: 3, rating: 1.25, weight: '15,869334164229500', discounts: 27.90}
          - {inventory_id: 4, rating: 4.55, weight: 7.09, discounts: '21,44533577859860'}
    expect:
      rows:
          - {inventory_id: 1, rating: 4.55, weight: 21.93, discounts: 26.06}
          - {inventory_id: 2, rating: 3.04, weight: 38.41, discounts: 20.65}
          - {inventory_id: 3, rating: 1.25, weight: 15.87, discounts: 27.90}
          - {inventory_id: 4, rating: 4.55, weight: 7.09, discounts: 21.45}

  - name: test_product_warranty_period
    description: "Check if warranty period is converted in dim product table"
    model: dim_product_michael_w
    given:
      - input: source('de_project', 'product_data') 
        rows:
          - {product_id: 'prod-00001', warranty_period: '22 months'}
          - {product_id: 'prod-00002', warranty_period: '32months'}
          - {product_id: 'prod-00003', warranty_period: '31  months'}
    expect:
      rows:
          - {product_id: 'prod-00001', warranty_period_in_month: 22}
          - {product_id: 'prod-00002', warranty_period_in_month: 32}
          - {product_id: 'prod-00003', warranty_period_in_month: 31}


