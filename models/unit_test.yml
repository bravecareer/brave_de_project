unit_tests:
  - name: test_inventory_format
    description: "Check if format of rating, weight and discount"
    model: dim_inventory_sp
    given:
      - input: ref('stg_inventory_sp') 
        rows:
          - {inventory_id: 1, rating: '1,5235', weight: '776,78', discounts: '545,7788765566'}
          - {inventory_id: 2, rating: '3,0401306928136800', weight: '3,39092019', discounts: '493,7796948390'}
          - {inventory_id: 3, rating: '2,5', weight: '31,869334164229500', discounts: '3,30022'}
    expect:
        rows:
          - {inventory_id: 1, rating: 1.52, weight: 776.78, discounts: 545.78}
          - {inventory_id: 2, rating: 3.04, weight: 3.39, discounts: 493.78}
          - {inventory_id: 3, rating: 2.50, weight: 31.87, discounts: 3.30}


 